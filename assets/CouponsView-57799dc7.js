import{M as b}from"./modal-5b497b75.js";import{_ as f,c as l,g as v,d as y,b as o,F as m,n as M,G as c,H as p,M as L,t as u,e as w,r as k,o as d}from"./index-57b645d5.js";const{VITE_APP_URL:r,VITE_APP_PATH:h}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"ufo060204",BASE_URL:"/Zongzi-Shop-Webside/",MODE:"production",DEV:!1,PROD:!0},x={data(){return{coupons:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},isLoading:!1,isNew:!1,color:"#FF700C",couponModal:"",delCouponModal:""}},methods:{getCoupon(){this.isLoading=!0;const s=`${r}api/${h}/admin/coupons`;this.$http.get(s,this.tempCoupon).then(t=>{this.coupons=t.data.coupons,this.isLoading=!1,console.log(t.data)}).catch(t=>{this.isLoading=!1,console.log(t.response)})},openCouponModal(s,t){this.isNew=s,this.isNew?this.tempCoupon={due_date:new Date().getTime()/1e3}:this.tempCoupon={...t},this.couponModal.show()},openDelCouponModal(s){this.tempCoupon={...s},this.delCouponModal.show()},updateCoupon(){this.isLoading=!0;let s=`${r}api/${h}/admin/coupon`,t="post",_=this.tempCoupon;this.isNew||(s=`${r}api/${h}/admin/coupon/${this.tempCoupon.id}`,t="put",_=this.tempCoupon),this.$http[t](s,{data:_}).then(i=>{this.isLoading=!1,this.getCoupon(),this.couponModal.hide(),console.log(i),alert(i.data.data.message)}).catch(i=>{this.isLoading=!1,console.log(i.response)})},dateFilter(s){return new Date(s*1e3).toLocaleDateString()},delCoupon(){this.isLoading=!0;const s=`${r}api/${h}/admin/coupon/${this.tempCoupon.id}`;this.$http.delete(s).then(t=>{this.isLoading=!1,this.getCoupon(),this.delCouponModal.hide(),console.log(t.data),alert(t.data.data.message)}).catch(t=>{this.isLoading=!1,console.log(t.response)})}},mounted(){this.getCoupon(),this.couponModal=new b(this.$refs.couponModal),this.delCouponModal=new b(this.$refs.delCouponModal)}},V={class:"text-end mt-4"},D={class:"table mt-4"},P=o("thead",null,[o("tr",null,[o("th",{width:"120"},"名稱"),o("th",{width:"120"},"折扣百分比例"),o("th",{width:"120"},"到期日"),o("th",{width:"100"},"是否啟用"),o("th",{width:"120"},"編輯")])],-1),N={key:0,class:"text-success"},T={key:1,class:"text-muted"},E={class:"btn-group"},U=["onClick"],A=["onClick"],F={id:"couponModal",ref:"couponModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},S={class:"modal-dialog modal-xl"},B={class:"modal-content border-0"},I={class:"modal-header bg-dark text-white"},R={id:"productModalLabel",class:"modal-title"},H={key:0},z={key:1},O=o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),G={class:"modal-body"},W={class:"mb-3"},Z=o("label",{for:"title"},"標題",-1),j={class:"mb-3"},q=o("label",{for:"coupon_code"},"優惠碼",-1),J={class:"mb-3"},K=o("label",{for:"due_date"},"期限",-1),Q={class:"mb-3"},X=o("label",{for:"price"},"折扣百分比例",-1),Y={class:"mb-3"},$={class:"form-check"},oo=o("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),to={class:"modal-footer"},eo=o("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),so={id:"delCouponModal",ref:"delCouponModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delCouponModalLabel","aria-hidden":"true"},no={class:"modal-dialog"},lo={class:"modal-content border-0"},ao=w('<div class="modal-header bg-danger text-white"><h5 id="delCouponModalLabel" class="modal-title"><span>刪除</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"> 是否刪除 <strong class="text-danger"></strong> 商品(刪除後將無法恢復)。 </div>',2),io={class:"modal-footer"},co=o("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function po(s,t,_,i,n,a){const C=k("VueLoading");return d(),l(m,null,[v(" 後台優惠券頁面 "),y(C,{active:n.isLoading,color:n.color,"z-index":9999},null,8,["active","color"]),o("div",V,[o("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=()=>a.openCouponModal(!0))}," 建立新的優惠券 ")]),o("table",D,[P,o("tbody",null,[(d(!0),l(m,null,M(n.coupons,(e,g)=>(d(),l("tr",{key:g},[o("td",null,u(e.title),1),o("td",null,u(e.percent),1),o("td",null,u(a.dateFilter(e.due_date)),1),o("td",null,[e.is_enabled===1?(d(),l("span",N,"啟用")):(d(),l("span",T,"未啟用"))]),o("td",null,[o("div",E,[o("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:()=>a.openCouponModal(!1,e)}," 編輯 ",8,U),o("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:()=>a.openDelCouponModal(e)}," 刪除 ",8,A)])])]))),128))])]),o("div",F,[o("div",S,[o("div",B,[o("div",I,[o("h5",R,[n.isNew?(d(),l("span",H,"新增優惠券")):(d(),l("span",z,"編輯優惠券"))]),O]),o("div",G,[o("div",W,[Z,c(o("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[1]||(t[1]=e=>n.tempCoupon.title=e),placeholder:"請輸入標題"},null,512),[[p,n.tempCoupon.title]])]),o("div",j,[q,c(o("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[2]||(t[2]=e=>n.tempCoupon.code=e),placeholder:"請輸入優惠碼"},null,512),[[p,n.tempCoupon.code]])]),o("div",J,[K,c(o("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[3]||(t[3]=e=>s.due_date=e)},null,512),[[p,s.due_date]])]),o("div",Q,[X,c(o("input",{type:"number",class:"form-control",id:"price",min:"0","onUpdate:modelValue":t[4]||(t[4]=e=>n.tempCoupon.percent=e),placeholder:"請輸入折扣百分比"},null,512),[[p,n.tempCoupon.percent]])]),o("div",Y,[o("div",$,[c(o("input",{type:"checkbox","true-value":1,"false-value":0,class:"form-check-input",id:"is_enabled","onUpdate:modelValue":t[5]||(t[5]=e=>n.tempCoupon.is_enabled=e)},null,512),[[L,n.tempCoupon.is_enabled]]),oo])])]),o("div",to,[eo,o("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=()=>a.updateCoupon(n.tempCoupon))},u(n.isNew?"新增優惠券":"更新優惠券"),1)])])])],512),o("div",so,[o("div",no,[o("div",lo,[ao,o("div",io,[co,o("button",{type:"button",class:"btn btn-danger",onClick:t[7]||(t[7]=()=>a.delCoupon())}," 確認刪除 ")])])])],512)],64)}const ho=f(x,[["render",po]]);export{ho as default};
