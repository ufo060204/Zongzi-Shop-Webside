import{M as _}from"./modal-79324e77.js";import{_ as f,c as d,g as v,b as t,F as b,n as P,t as u,s as c,u as r,A as y,e as U,o as i}from"./index-4adfc113.js";const{VITE_APP_URL:m,VITE_APP_PATH:h}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"ufo060204",BASE_URL:"/Zongzi-Shop-Webside/",MODE:"production",DEV:!1,PROD:!0},k={data(){return{products:[],tempProduct:{imagesUrl:[]},isNew:!1,productModal:"",delProductModal:""}},methods:{getProducts(){const l=`${m}api/${h}/admin/articles`;this.$http.get(l).then(e=>{this.products=e.data.articles,console.log(this.products),console.log(e)}).catch(e=>{alert(e.data.message)})},getContent(l){const e=`${m}api/${h}/admin/article/${l}`;this.$http.get(e).then(a=>{console.log(a.data.article.content)}).catch(a=>{alert(a.data.message)})},openModal(l,e){l==="create"?(this.productModal.show(),this.isNew=!0,this.tempProduct={imagesUrl:[]}):l==="edit"?(this.productModal.show(),this.isNew=!1,this.tempProduct={...e}):l==="delete"&&(this.delProductModal.show(),this.tempProduct={...e})},updateProduct(){let l=`${m}api/${h}/admin/article`,e="post";this.isNew||(l=`${m}api/${h}/admin/article/${this.tempProduct.id}`,e="put"),this.$http[e](l,{data:this.tempProduct}).then(a=>{alert(a.data.message),this.getProducts(),this.productModal.hide()}).catch(a=>{alert(a.data.message)})},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")},deleteProduct(){const l=`${m}api/${h}/admin/article/${this.tempProduct.id}`;this.$http.delete(l).then(e=>{alert(e.data.message),this.getProducts(),this.delProductModal.hide()}).catch(e=>{alert(e.data.message)})}},components:{},mounted(){this.getProducts(),this.productModal=new _(this.$refs.productModal),this.delProductModal=new _(this.$refs.delProductModal)}},M={class:"container"},w={class:"text-end mt-4"},x={class:"table mt-4"},C=t("thead",null,[t("tr",null,[t("th",{width:"120"},"日期"),t("th",null,"標題"),t("th",{width:"120"},"作者"),t("th",{width:"120"},"描述"),t("th",{width:"120"},"內容"),t("th",{width:"100"},"是否公開"),t("th",{width:"120"},"編輯")])],-1),V=["onClick"],A={key:0,class:"text-success"},E={key:1},L={class:"btn-group"},N=["onClick"],T=["onClick"],I={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},D={class:"modal-dialog modal-xl"},B={class:"modal-content border-0"},R={class:"modal-header bg-dark text-white"},S={id:"productModalLabel",class:"modal-title"},F=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),H={class:"modal-body"},O={class:"row"},z={class:"col-sm-4"},W={class:"mb-2"},Z={class:"mb-3"},j=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),q=["src"],G=t("h4",null,"多圖設置",-1),J=["onUpdate:modelValue"],K=["src"],Q={key:1},X={class:"col-sm-8"},Y={class:"mb-3"},$=t("label",{for:"title",class:"form-label"},"標題",-1),tt={class:"row"},et=t("div",{class:"mb-3 col-md-6"},null,-1),st={class:"mb-3 col-md-6"},ot=t("label",{for:"price",class:"form-label"},"作者",-1),lt={class:"row"},dt={class:"mb-3 col-md-6"},it=t("label",{for:"create_at",class:"form-label"},"日期",-1),nt=t("div",{class:"mb-3 col-md-6"},null,-1),at=t("hr",null,null,-1),ct={class:"mb-3"},rt=t("label",{for:"content",class:"form-label"},"文章內容",-1),ut={class:"mb-3"},mt=t("label",{for:"description",class:"form-label"},"文章",-1),ht={class:"mb-3"},pt={class:"form-check"},bt=t("label",{class:"form-check-label",for:"isPublic"},"是否公開",-1),_t={class:"modal-footer"},Pt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),gt={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},ft={class:"modal-dialog"},vt={class:"modal-content border-0"},yt=U('<div class="modal-header bg-danger text-white"><h5 id="delProductModalLabel" class="modal-title"><span>刪除產品</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"> 是否刪除 <strong class="text-danger"></strong> 商品(刪除後將無法恢復)。 </div>',2),Ut={class:"modal-footer"},kt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Mt(l,e,a,wt,o,n){return i(),d(b,null,[v(" 後台文章列表 "),t("div",M,[t("div",w,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=()=>n.openModal("create"))}," 建立新的文章 ")]),t("table",x,[C,t("tbody",null,[(i(!0),d(b,null,P(o.products,s=>(i(),d("tr",{key:s.id},[t("td",null,u(s.create_at),1),t("td",null,u(s.title),1),t("td",null,u(s.author),1),t("td",null,u(s.description),1),t("td",null,[t("button",{type:"button",onClick:()=>n.getContent(s.id)},"查看",8,V)]),t("td",null,[s.isPublic?(i(),d("span",A,"公開")):(i(),d("span",E,"未啟用"))]),t("td",null,[t("div",L,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:()=>n.openModal("edit",s)}," 編輯 ",8,N),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:()=>n.openModal("delete",s)}," 刪除 ",8,T)])])]))),128))])])]),t("div",I,[t("div",D,[t("div",B,[t("div",R,[t("h5",S,[t("span",null,u(o.isNew?"新增文章":"編輯文章"),1)]),F]),t("div",H,[t("div",O,[t("div",z,[t("div",W,[t("div",Z,[j,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[1]||(e[1]=s=>o.tempProduct.imageUrl=s)},null,512),[[r,o.tempProduct.imageUrl]])]),t("img",{class:"img-fluid",src:o.tempProduct.imageUrl,alt:""},null,8,q)]),t("div",null,[G,Array.isArray(o.tempProduct.imagesUrl)?(i(),d(b,{key:0},[(i(!0),d(b,null,P(o.tempProduct.imagesUrl,(s,p)=>(i(),d("div",{key:p+1234},[c(t("input",{type:"text",class:"form-control","onUpdate:modelValue":g=>o.tempProduct.imagesUrl[p]=g},null,8,J),[[r,o.tempProduct.imagesUrl[p]]]),t("img",{src:o.tempProduct.imagesUrl[p],alt:"",class:"img-fluid mb-2"},null,8,K)]))),128)),!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(i(),d("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=()=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")):(i(),d("button",{key:1,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[3]||(e[3]=()=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 "))],64)):(i(),d("div",Q,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[4]||(e[4]=(...s)=>n.createImages&&n.createImages(...s))}," 新增圖片 ")]))])]),t("div",X,[t("div",Y,[$,c(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.title=s)},null,512),[[r,o.tempProduct.title]])]),t("div",tt,[et,t("div",st,[ot,c(t("input",{id:"author",type:"text",class:"form-control",placeholder:"請輸入作者","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.author=s)},null,512),[[r,o.tempProduct.author]])])]),t("div",lt,[t("div",dt,[it,c(t("input",{id:"create_at",type:"number",min:"0",class:"form-control",placeholder:"請輸入日期","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.create_at=s)},null,512),[[r,o.tempProduct.create_at,void 0,{number:!0}]])]),nt]),at,t("div",ct,[rt,c(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入文章內容","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.content=s)},`\r
                `,512),[[r,o.tempProduct.content]])]),t("div",ut,[mt,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入文章描述","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.description=s)},`\r
                `,512),[[r,o.tempProduct.description]])]),t("div",ht,[t("div",pt,[c(t("input",{id:"isPublic",class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,"onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.isPublic=s)},null,512),[[y,o.tempProduct.isPublic]]),bt])])])])]),t("div",_t,[Pt,t("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=(...s)=>n.updateProduct&&n.updateProduct(...s))}," 確認 ")])])])],512),t("div",gt,[t("div",ft,[t("div",vt,[yt,t("div",Ut,[kt,t("button",{type:"button",class:"btn btn-danger",onClick:e[12]||(e[12]=()=>n.deleteProduct())}," 確認刪除 ")])])])],512)],64)}const Vt=f(k,[["render",Mt]]);export{Vt as default};
