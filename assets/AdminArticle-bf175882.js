import{M as _}from"./modal-abf21b64.js";import{_ as v,c as d,g as y,d as U,b as t,F as b,n as P,t as u,G as c,H as r,M,e as k,r as w,o as i}from"./index-22918edb.js";const{VITE_APP_URL:m,VITE_APP_PATH:h}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"ufo060204",BASE_URL:"/Zongzi-Shop-Webside/",MODE:"production",DEV:!1,PROD:!0},x={data(){return{products:[],tempProduct:{imagesUrl:[]},isNew:!1,isLoading:!1,color:"#FF700C",productModal:"",delProductModal:""}},methods:{getProducts(){const l=`${m}api/${h}/admin/articles`;this.isLoading=!0,this.$http.get(l).then(e=>{this.products=e.data.articles,this.isLoading=!1,console.log(this.products),console.log(e)}).catch(e=>{alert(e.data.message)})},getContent(l){const e=`${m}api/${h}/admin/article/${l}`;this.$http.get(e).then(a=>{console.log(a.data.article.content)}).catch(a=>{alert(a.data.message)})},openModal(l,e){l==="create"?(this.productModal.show(),this.isNew=!0,this.tempProduct={imagesUrl:[]}):l==="edit"?(this.productModal.show(),this.isNew=!1,this.tempProduct={...e}):l==="delete"&&(this.delProductModal.show(),this.tempProduct={...e})},updateProduct(){let l=`${m}api/${h}/admin/article`,e="post";this.isNew||(l=`${m}api/${h}/admin/article/${this.tempProduct.id}`,e="put"),this.$http[e](l,{data:this.tempProduct}).then(a=>{alert(a.data.message),this.getProducts(),this.productModal.hide()}).catch(a=>{alert(a.data.message)})},createImages(){this.tempProduct.imagesUrl=[],this.tempProduct.imagesUrl.push("")},deleteProduct(){const l=`${m}api/${h}/admin/article/${this.tempProduct.id}`;this.$http.delete(l).then(e=>{alert(e.data.message),this.getProducts(),this.delProductModal.hide()}).catch(e=>{alert(e.data.message)})}},components:{},mounted(){this.getProducts(),this.productModal=new _(this.$refs.productModal),this.delProductModal=new _(this.$refs.delProductModal)}},V={class:"container"},C={class:"text-end mt-4"},L={class:"table mt-4"},A=t("thead",null,[t("tr",null,[t("th",{width:"120"},"日期"),t("th",null,"標題"),t("th",{width:"120"},"作者"),t("th",{width:"120"},"描述"),t("th",{width:"120"},"內容"),t("th",{width:"100"},"是否公開"),t("th",{width:"120"},"編輯")])],-1),N=["onClick"],E={key:0,class:"text-success"},T={key:1},I={class:"btn-group"},D=["onClick"],B=["onClick"],F={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},R={class:"modal-dialog modal-xl"},S={class:"modal-content border-0"},H={class:"modal-header bg-dark text-white"},z={id:"productModalLabel",class:"modal-title"},O=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),G={class:"modal-body"},W={class:"row"},Z={class:"col-sm-4"},j={class:"mb-2"},q={class:"mb-3"},J=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),K=["src"],Q=t("h4",null,"多圖設置",-1),X=["onUpdate:modelValue"],Y=["src"],$={key:1},tt={class:"col-sm-8"},et={class:"mb-3"},ot=t("label",{for:"title",class:"form-label"},"標題",-1),st={class:"row"},lt=t("div",{class:"mb-3 col-md-6"},null,-1),dt={class:"mb-3 col-md-6"},it=t("label",{for:"price",class:"form-label"},"作者",-1),nt={class:"row"},at={class:"mb-3 col-md-6"},ct=t("label",{for:"create_at",class:"form-label"},"日期",-1),rt=t("div",{class:"mb-3 col-md-6"},null,-1),ut=t("hr",null,null,-1),mt={class:"mb-3"},ht=t("label",{for:"content",class:"form-label"},"文章內容",-1),pt={class:"mb-3"},bt=t("label",{for:"description",class:"form-label"},"文章",-1),_t={class:"mb-3"},Pt={class:"form-check"},gt=t("label",{class:"form-check-label",for:"isPublic"},"是否公開",-1),ft={class:"modal-footer"},vt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),yt={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Ut={class:"modal-dialog"},Mt={class:"modal-content border-0"},kt=k('<div class="modal-header bg-danger text-white"><h5 id="delProductModalLabel" class="modal-title"><span>刪除產品</span></h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"> 是否刪除 <strong class="text-danger"></strong> 商品(刪除後將無法恢復)。 </div>',2),wt={class:"modal-footer"},xt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Vt(l,e,a,Ct,o,n){const g=w("VueLoading");return i(),d(b,null,[y(" 後台文章列表 "),U(g,{active:o.isLoading,color:o.color,"z-index":9999},null,8,["active","color"]),t("div",V,[t("div",C,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=()=>n.openModal("create"))}," 建立新的文章 ")]),t("table",L,[A,t("tbody",null,[(i(!0),d(b,null,P(o.products,s=>(i(),d("tr",{key:s.id},[t("td",null,u(s.create_at),1),t("td",null,u(s.title),1),t("td",null,u(s.author),1),t("td",null,u(s.description),1),t("td",null,[t("button",{type:"button",onClick:()=>n.getContent(s.id)},"查看",8,N)]),t("td",null,[s.isPublic?(i(),d("span",E,"公開")):(i(),d("span",T,"未啟用"))]),t("td",null,[t("div",I,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:()=>n.openModal("edit",s)}," 編輯 ",8,D),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:()=>n.openModal("delete",s)}," 刪除 ",8,B)])])]))),128))])])]),t("div",F,[t("div",R,[t("div",S,[t("div",H,[t("h5",z,[t("span",null,u(o.isNew?"新增文章":"編輯文章"),1)]),O]),t("div",G,[t("div",W,[t("div",Z,[t("div",j,[t("div",q,[J,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[1]||(e[1]=s=>o.tempProduct.imageUrl=s)},null,512),[[r,o.tempProduct.imageUrl]])]),t("img",{class:"img-fluid",src:o.tempProduct.imageUrl,alt:""},null,8,K)]),t("div",null,[Q,Array.isArray(o.tempProduct.imagesUrl)?(i(),d(b,{key:0},[(i(!0),d(b,null,P(o.tempProduct.imagesUrl,(s,p)=>(i(),d("div",{key:p+1234},[c(t("input",{type:"text",class:"form-control","onUpdate:modelValue":f=>o.tempProduct.imagesUrl[p]=f},null,8,X),[[r,o.tempProduct.imagesUrl[p]]]),t("img",{src:o.tempProduct.imagesUrl[p],alt:"",class:"img-fluid mb-2"},null,8,Y)]))),128)),!o.tempProduct.imagesUrl.length||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(i(),d("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=()=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")):(i(),d("button",{key:1,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[3]||(e[3]=()=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 "))],64)):(i(),d("div",$,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[4]||(e[4]=(...s)=>n.createImages&&n.createImages(...s))}," 新增圖片 ")]))])]),t("div",tt,[t("div",et,[ot,c(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.title=s)},null,512),[[r,o.tempProduct.title]])]),t("div",st,[lt,t("div",dt,[it,c(t("input",{id:"author",type:"text",class:"form-control",placeholder:"請輸入作者","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.author=s)},null,512),[[r,o.tempProduct.author]])])]),t("div",nt,[t("div",at,[ct,c(t("input",{id:"create_at",type:"number",min:"0",class:"form-control",placeholder:"請輸入日期","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.create_at=s)},null,512),[[r,o.tempProduct.create_at,void 0,{number:!0}]])]),rt]),ut,t("div",mt,[ht,c(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入文章內容","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.content=s)},`\r
                `,512),[[r,o.tempProduct.content]])]),t("div",pt,[bt,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入文章描述","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempProduct.description=s)},`\r
                `,512),[[r,o.tempProduct.description]])]),t("div",_t,[t("div",Pt,[c(t("input",{id:"isPublic",class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,"onUpdate:modelValue":e[10]||(e[10]=s=>o.tempProduct.isPublic=s)},null,512),[[M,o.tempProduct.isPublic]]),gt])])])])]),t("div",ft,[vt,t("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=(...s)=>n.updateProduct&&n.updateProduct(...s))}," 確認 ")])])])],512),t("div",yt,[t("div",Ut,[t("div",Mt,[kt,t("div",wt,[xt,t("button",{type:"button",class:"btn btn-danger",onClick:e[12]||(e[12]=()=>n.deleteProduct())}," 確認刪除 ")])])])],512)],64)}const Nt=v(x,[["render",Vt]]);export{Nt as default};
