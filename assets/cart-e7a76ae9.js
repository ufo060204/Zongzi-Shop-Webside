import{d,a as s,r as l}from"./index-ec33a842.js";import{S as e}from"./sweetalert2.all-6567ce3e.js";const{VITE_APP_URL:i,VITE_APP_PATH:r}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"ufo060204",BASE_URL:"/Zongzi-Shop-Webside/",MODE:"production",DEV:!1,PROD:!0},p=d("cart",{state:()=>({cart:[],total:0,final_total:0,isLoading:!1,couponCode:"",color:"#FF700C",fullPage:!0,qty:1}),actions:{getCarts(){this.isLoading=!0,s.get(`${i}v2/api/${r}/cart`).then(t=>{this.cart=t.data.data.carts,this.total=t.data.data.total,this.final_total=t.data.data.final_total,this.isLoading=!1}).catch(t=>{alert(t.data.message)})},addToCart(t,o=1){const a={product_id:t,qty:o};s.post(`${i}v2/api/${r}/cart`,{data:a}).then(c=>{this.getCarts(),e.fire({icon:"success",title:"加入購物車成功",showConfirmButton:!1,timer:1500})}).catch(c=>{alert(c.message)})},deleteCartItem(t){this.loadingItem=t.id,s.delete(`${i}v2/api/${r}/cart/${t.id}`).then(o=>{this.loadingItem="",this.getCarts(),e.fire({icon:"success",title:"刪除產品成功",showConfirmButton:!1,timer:1500})}).catch(o=>{alert(o.data.message)})},checkCoupon(){const t={code:this.couponCode},o=`${i}/v2/api/${r}/coupon`;s.post(o,{data:t}).then(a=>{a.data.success===!0?(this.getCarts(),e.fire({showConfirmButton:!1,icon:"success",title:"套用成功",text:"已套用優惠券 zongzi40",timer:1e3})):a.data.success===!1&&e.fire({icon:"error",title:"套用失敗",text:"找不到優惠券",footer:'<a href="#" class="goGetCoupon">前往領取優惠碼</a>',didOpen:()=>{e.getPopup().querySelector(".goGetCoupon").addEventListener("click",n=>{n.preventDefault(),l.push("/home/-NR8JzTIYKZ08sSYBdjQ"),e.close()})}})}).catch(a=>{e.fire(a.response.data.message)})},pay(){e.fire({title:"結帳確認",text:"確認資料無誤並結帳嗎?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(t=>{if(t.isConfirmed){const o=`${i}v2/api/${r}/pay/${this.orderId}`;s.post(o).then(a=>{this.cart=[],e.fire("付款完成","您已完成結帳","success"),this.$router.push("/orderFinished")})}})}},getters:{}});export{p as c};
